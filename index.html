<!DOCTYPE html>
<html>
  <head>
    <link href = "style.css" rel = "stylesheet">
    <title><em>TESTING!!!</em></title>
  </head>
  <body>
  <header class = "bolded big black coolbg center">
    <h2 style = "font-family: Arial"><strong><em>TESTING SITE BACK OFF</em></strong></h2>
  </header>
<div class = "centered">
  <div class = "buttons">
  <input class = "center" placeholder = "Enter name" maxlength = "15" name = "name" id = "name"><br><br><br><br>
  <button class = "center" id = "getAge"><strong>Get Age and Gender!!</strong></button>
  </div>
  <div class = "blackbox">
  <div class = "results">
  <p id = "result"></p><div class = "space"></div>
  </div>
  <div class = "genders">
  <p id = "gender"></p>
  </div>
  </div>
</div>
  <script>
    document.getElementById("getAge").addEventListener('click', ()=>{
      const name = document.getElementById("name").value;
      fetch(`https://backend-9pa3.onrender.com/getAgeGender`, {
        method: "POST",
        headers: {
         "Content-Type":"application/json",
        },   
      body: JSON.stringify({name:name})
    })
        .then(response => response.json())
        .then(data => {
           const resultBox = document.querySelector(".blackbox");
          resultBox.classList.remove("flash-success", "flash-error");
          void resultBox.offsetWidth; 
          resultBox.classList.add("flash-success");
          document.getElementById("result").textContent = `Your age for ${name}: ${(data.age)%50}`;
          console.log(data.age);
          document.getElementById("gender").textContent = `There is a `+(Math.ceil((data.probability)*100))+`% chance that you are a ${data.gender}`;
          console.log(data.gender +"\n" + data.probability);
        })
        .catch(error => {
            const resultBox = document.querySelector(".blackbox");
            resultBox.classList.remove("flash-success", "flash-error");
            void resultBox.offsetWidth; 
            resultBox.classList.add("flash-error");
            console.error(error);
            document.getElementById("result").textContent = `Error, if this happends a lot, it probably means the`;
            document.getElementById("gender").textContent = `APIs or BACKEND are down (try again later).`; 
        })
    });
    const input = document.getElementById("name");
    input.addEventListener('input', ()=> {
        input.classList.remove("typing");
        void input.offsetWidth;
        input.classList.add("typing");
    });
  </script>
  </body>
</html>
